/**
https://twitter.com/yukifuyuki
https://www.twitch.tv/yukifuyuki
*/
let r=[],c=[],d=0,t,a;function buttonClick(){var e=m(document.getElementById("fcid").value);!1===e?s("Invalid FC URL or ID"):n(e)}function n(e){y(),s("Fetching FC "+e);let n=a=Date.now();fetch(`https://xivapi.com/freecompany/${e}?data=FCM`,{mode:"cors"}).then(e=>e.json()).then(e=>{n===a&&(void 0===e.FreeCompany?s("Could not find FC. Please double check URL or ID."):(s(`Found FC ${e.FreeCompany.Name} on `+e.FreeCompany.Server),o((t=e).FreeCompanyMembers,n)))})}function o(t,a){d=t.length,s(`Fetching FC members data for ${t.length} members. This should take around ${Math.round(1.1*t.length)} seconds.`);for(var o=0;o<t.length;o++){let e=t[o].ID,n=a;r.push(setTimeout(()=>l(e,n),1100*(o+1)))}}function l(e,n){fetch("https://xivapi.com/character/"+e).then(e=>e.json()).then(e=>u(e,n))}function u(e,n){n===a&&0!==d&&(0<c.length&&g(),c.push(e),s(`Checked ${c.length} members out of ${d} total. ETA ${Math.round(1.1*(d-c.length))} seconds.`),c.length===d&&h())}function h(){var n=0,e=(c.forEach(e=>{4===e.Character.Race&&2===e.Character.Gender&&n++}),`${t.FreeCompany.Name} FC on ${t.FreeCompany.Server} has ${n} catgirls. This is ${Math.round(1e3*n/c.length)/10}% of the ${c.length} members.`),e=(s(`<b>${e}</b>`),`https://twitter.com/intent/tweet?url=https%3A%2F%2Fyukifuyuki.github.io%2Ffc-catgirls%2F&text=${encodeURIComponent(e)}&hashtags=FFXIV`);s(`<a href="${e}">Share on Twitter</a>`),document.getElementById("advancedToggle").style.display="",filterAdvanced()}function filterAdvanced(){var n=parseInt(document.querySelector('input[name="gender"]:checked').value),t=parseInt(document.querySelector('input[name="race"]:checked').value),a=(console.log(n),console.log(t),0),o=document.getElementById("advOutput");o.innerHTML='<hr><p id="advSummary"></p><p>',c.forEach(e=>{0!==t&&e.Character.Race!==t||0!==n&&e.Character.Gender!==n||(a++,o.innerHTML+=e.Character.Name+"<br>")}),o.innerHTML+="</p>",document.getElementById("advSummary").innerHTML=`${a} (${Math.round(1e3*a/c.length)/10}%) are ${e(n)} `+i(t)}function e(e){return 2===e?"female":0===e?"any gender":1===e?"male":void 0}function i(e){return 4===e?"Miqo'te":0===e?"any race":1===e?"Hyur":2===e?"Elezen":3===e?"Lalafell":5===e?"Roegadyn":6===e?"Au Ra":7===e?"Hrothgar":8===e?"Viera":void 0}function m(e){var n,t;return e.match(/^\d+$/)||(t=e.indexOf(n="any/"),0<(t=(e=e.substring(t+n.length)).indexOf("/"))&&(e=e.substring(0,t))),!!e.match(/^\d+$/)&&e}function s(e){document.getElementById("log").innerHTML+=`<p>${e}</p>`}function g(){var e,n=document.getElementById("log");n.hasChildNodes()&&(e=n.childNodes,n.removeChild(e[e.length-1]))}function f(){document.getElementById("log").innerHTML=""}function y(){f(),c=[],d=0,t=null,a=null,document.getElementById("advancedToggle").style.display="none",p=!0,toggleAdvanced();for(var e=0;e<r.length;e++)clearTimeout(r[e])}var p=!1;function toggleAdvanced(){p=!p,document.getElementById("advanced").style.display=p?"":"none"}