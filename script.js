/**
https://twitter.com/yukifuyuki
https://www.twitch.tv/yukifuyuki
*/
let a=[],n=[],h=0,o,r;function buttonClick(){var e=m(document.getElementById("fcid").value);!1===e?d("Invalid FC URL or ID"):t(e)}function t(e){f(),d("Fetching FC "+e);let t=r=Date.now();fetch(`https://xivapi.com/freecompany/${e}?data=FCM`,{mode:"cors"}).then(e=>e.json()).then(e=>{t===r&&(void 0===e.FreeCompany?d("Could not find FC. Please double check URL or ID."):(d(`Found FC ${e.FreeCompany.Name} on `+e.FreeCompany.Server),i((o=e).FreeCompanyMembers,t)))})}function i(n,o){h=n.length,d(`Fetching FC members data for ${n.length} members. This should take around ${Math.round(1.1*n.length)} seconds.`);for(var r=0;r<n.length;r++){let e=n[r].ID,t=o;a.push(setTimeout(()=>c(e,t),1100*(r+1)))}}function c(e,t){fetch("https://xivapi.com/character/"+e).then(e=>e.json()).then(e=>l(e,t))}function l(e,t){t===r&&0!==h&&(0<n.length&&s(),n.push(e),d(`Checked ${n.length} members out of ${h} total. ETA ${Math.round(1.1*(h-n.length))} seconds.`),n.length===h&&u())}function u(){var t=0,e=(n.forEach(e=>{4===e.Character.Race&&2===e.Character.Gender&&t++}),`${o.FreeCompany.Name} FC on ${o.FreeCompany.Server} has ${t} catgirls. This is ${Math.round(1e3*t/n.length)/10}% of the ${n.length} members.`),e=(d(e),`https://twitter.com/intent/tweet?url=https%3A%2F%2Fyukifuyuki.github.io%2Ffc-catgirls%2F&text=${encodeURIComponent(e)}&hashtags=FFXIV`);d(`<a href="${e}">Share on Twitter</a>`)}function m(e){var t,n;return e.match(/^\d+$/)||(n=e.indexOf(t="any/"),0<(n=(e=e.substring(n+t.length)).indexOf("/"))&&(e=e.substring(0,n))),!!e.match(/^\d+$/)&&e}function d(e){document.getElementById("log").innerHTML+=`<p>${e}</p>`}function s(){var e,t=document.getElementById("log");t.hasChildNodes()&&(e=t.childNodes,t.removeChild(e[e.length-1]))}function g(){document.getElementById("log").innerHTML=""}function f(){g(),n=[],h=0,o=null,timestamp=null;for(var e=0;e<a.length;e++)clearTimeout(a[e])}