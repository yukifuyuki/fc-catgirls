/**
https://twitter.com/yukifuyuki
https://www.twitch.tv/yukifuyuki
*/
let o=[],c=[],d=0,t,a;function buttonClick(){var e=s(document.getElementById("fcid").value);!1===e?g("Invalid FC URL or ID"):n(e)}function n(e){p(),g("Fetching FC "+e);let n=a=Date.now();fetch(`https://xivapi.com/freecompany/${e}?data=FCM`,{mode:"cors"}).then(e=>e.json()).then(e=>{n===a&&(void 0===e.FreeCompany?g("Could not find FC. Please double check URL or ID."):(g(`Found FC ${e.FreeCompany.Name} on `+e.FreeCompany.Server),r((t=e).FreeCompanyMembers,n)))})}function r(t,a){d=t.length,g(`Fetching FC members data for ${t.length} members. This should take around ${Math.round(1.1*t.length)} seconds.`);for(var r=0;r<t.length;r++){let e=t[r].ID,n=a;o.push(setTimeout(()=>u(e,n),1100*(r+1)))}}function u(e,n){fetch("https://xivapi.com/character/"+e).then(e=>e.json()).then(e=>l(e,n))}function l(e,n){n===a&&0!==d&&(0<c.length&&f(),c.push(e),g(`Checked ${c.length} members out of ${d} total. ETA ${Math.round(1.1*(d-c.length))} seconds.`),c.length===d&&i())}function i(){var n=0,e=(c.forEach(e=>{4===e.Character.Race&&2===e.Character.Gender&&n++}),`${t.FreeCompany.Name} FC on ${t.FreeCompany.Server} has ${n} catgirls. This is ${Math.round(1e3*n/c.length)/10}% of the ${c.length} members.`),e=(g(`<b>${e}</b>`),`https://twitter.com/intent/tweet?url=https%3A%2F%2Fyukifuyuki.github.io%2Ffc-catgirls%2F&text=${encodeURIComponent(e)}&hashtags=FFXIV`);g(`<a href="${e}">Share on Twitter</a>`),document.getElementById("advancedToggle").style.display="",filterAdvanced()}function filterAdvanced(){var n=parseInt(document.querySelector('input[name="gender"]:checked').value),t=parseInt(document.querySelector('input[name="race"]:checked').value),a=0,r=document.getElementById("advOutput");r.innerHTML='<hr><p id="advSummary"></p><p>',c.forEach(e=>{0!==t&&e.Character.Race!==t||0!==n&&e.Character.Gender!==n||(a++,r.innerHTML+=e.Character.Name+"<br>")}),r.innerHTML+="</p>",document.getElementById("advSummary").innerHTML=`<b>${a} (${Math.round(1e3*a/c.length)/10}%) are ${e(n,t)}.</b>`}function e(e,n){return 2===e&&4===n?"catgirls":h(e)+" "+m(n)}function h(e){return 2===e?"female":0===e?"any gender":1===e?"male":void 0}function m(e){return 4===e?"Miqo'te":0===e?"any race":1===e?"Hyur":2===e?"Elezen":3===e?"Lalafell":5===e?"Roegadyn":6===e?"Au Ra":7===e?"Hrothgar":8===e?"Viera":void 0}function s(e){var n,t;return e.match(/^\d+$/)||(t=e.indexOf(n="any/"),0<(t=(e=e.substring(t+n.length)).indexOf("/"))&&(e=e.substring(0,t))),!!e.match(/^\d+$/)&&e}function g(e){document.getElementById("log").innerHTML+=`<p>${e}</p>`}function f(){var e,n=document.getElementById("log");n.hasChildNodes()&&(e=n.childNodes,n.removeChild(e[e.length-1]))}function y(){document.getElementById("log").innerHTML=""}function p(){y(),c=[],d=0,t=null,a=null,document.getElementById("advancedToggle").style.display="none",v=!0,toggleAdvanced();for(var e=0;e<o.length;e++)clearTimeout(o[e])}var v=!1;function toggleAdvanced(){v=!v,document.getElementById("advanced").style.display=v?"":"none"}